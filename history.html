<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ประวัติการวิเคราะห์ | Durian Analytics</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <style>
    body{font-family:"Prompt",system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--text-color);margin:0;background:var(--background-color);}
    header{border-bottom:1px solid var(--border-color);}    
    .container{padding:20px}
    .header-content{display:flex;justify-content:space-between;align-items:center;padding:10px 0}
    .nav-brand{display:flex;align-items:center;gap:10px;color:var(--text-color);text-decoration:none}
    .nav-logo{height:40px;width:40px;border-radius:10px}
    .animate-color{background:linear-gradient(90deg,var(--primary-color),var(--secondary-color));-webkit-background-clip:text;background-clip:text;color:transparent}
    .back-home-button{border:1px solid var(--border-color);padding:8px 14px;border-radius:10px;text-decoration:none;color:var(--text-color)}
    .card{background:#fff;border:1px solid var(--border-color);border-radius:16px;padding:18px}
    table{width:100%;border-collapse:collapse}
    thead th{position:sticky;top:0;background:#fff;z-index:1}
    th,td{padding:10px 12px;border-bottom:1px solid var(--border-color);vertical-align:top}
    tr:hover{background:#FAFCFF}
    .cell-date{white-space:nowrap;width:140px}
    .cell-result{white-space:nowrap;width:180px}
    .pill{display:inline-block;background:var(--background-color);border:1px solid var(--border-color);padding:2px 10px;border-radius:12px;margin:2px}
    .modal-bg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.25);z-index:10000;align-items:center;justify-content:center}
    .modal{background:#fff;min-width:320px;max-width:900px;width:90vw;padding:24px;border-radius:16px;position:relative}
    .close{position:absolute;top:10px;right:12px;font-size:22px;background:none;border:none;color:#888;cursor:pointer}
    .chart-box{display:flex;gap:24px;justify-content:center;margin-top:12px}
    .chart-cell{text-align:center}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <a href="index.html" class="nav-brand">
          <img src="assets/logo.png" class="nav-logo" alt="logo" />
          <h1 class="animate-color">Durian Analytics</h1>
        </a>
        <a href="index.html" class="back-home-button">← กลับหน้าแรก</a>
      </div>
    </div>
  </header>
  <main>
    <div class="container">
      <div class="dashboard-title">
        <h1>ประวัติการวิเคราะห์</h1>
      </div>
      <div class="card">
        <div id="history-table"></div>
      </div>
    </div>
  </main>

  <div class="modal-bg" id="history-modal">
    <div class="modal">
      <button class="close" id="history-modal-close" aria-label="ปิดหน้าต่าง">×</button>
      <h3 style="margin-top:0">รายละเอียดการวิเคราะห์</h3>
      <div id="modal-detail"></div>
      <div class="chart-box">
        <div class="chart-cell">
          <div style="font-weight:600;margin-bottom:6px">กราฟความรู้สึก</div>
          <canvas id="modal-sentiment-chart" width="240" height="240"></canvas>
        </div>
      </div>
      <div style="margin-top:14px">
        <div style="font-weight:600;margin-bottom:6px">คำแนะนำแคมเปญ (ถ้ามี)</div>
        <div id="modal-suggestion" style="background:var(--background-color);padding:10px 14px;border-radius:10px;border:1px solid var(--border-color)"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="config.js"></script>
  <script src="js/ui-utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/storage-manager.js"></script>
  <script src="js/history.js"></script>
</body>
</html>
